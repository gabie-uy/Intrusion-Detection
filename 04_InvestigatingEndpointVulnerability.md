# Investigating Compromised Endpoints

- With the resources and information they have, an analyst can study the behavior and history log of the organization. It will help them understand the ordinary activities and movements of the organization and the people using the systems. It can help deduce unexpected and unusual activities in logs. Unusual logs – even at least a small percentage of change, will make a slight difference in how it will look in the logs. The criticality of these alerts will depend on the specific effects it has caused or will cause. An example of an alert that could be treated as highly important is randomly deleted logs. The logs in an organization are meant to keep track of activities. Deleting or clearing logs will cause confusion and suspicious questions about why these have occurred. It may mean someone is trying to hide their activities, avoid consequences, etcetera. It is crucial for an organization to have complete information on its activities because when an incident occurs, it can easily track and figure out what to do immediately. Determining and fixing problems like those can help the organization from slowing down or shutting down. It will not hinder customers from using the system, it will not stop the organization's productivity, and business will not collapse in even the most minor ways. To stabilize the organization's business, it is crucial to have transparency for all systems, activities, and people.

- If a device or system gets compromised, the organization's analysts or security can look at audit logs to immediately see and investigate where and when the device was compromised. They can understand who may have done it, what time it was done, and the possibilities of the compromised activities. 

- The IT security team or an organization should always watch the activities in their systems. It is also vital to constantly update and maintain their systems and protect them from unwanted threats and attackers. Attackers may easily pretend to be a worker and infiltrate the systems and activities of the organization to throw them off their guards – causing extreme disorganization. 

## Images

<img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/ad3150d0-d745-4ba1-98dc-6330b8690761">

      _sourceCategory=Labs/Windows/OS/Windows

<img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/be59d303-4d5a-47c2-936a-720d2f4cafcd">
      
      _sourceCategory=Labs/Windows/OS/Windows
      | where eventid = "1102"     

<img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/ab41f1d9-2687-412a-acfc-58d83d884b2b">
     
    (_sourceCategory=Labs/Windows/OS/Windows) 
    | parse "ComputerName = \"*\";" as computer 
    | where eventid = "1102" 
    
<img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/285730ce-cd16-445e-a717-9694ed337a25">
    
    _sourceCategory=Labs/Windows/OS/Windows | parse "Message = \"*." as message
    | parse "ComputerName = \"*\";" as computer
    | where eventid = "1102" 
    | count by computer, message, eventid 

<img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/4edf7242-f3c4-473a-a6e1-6bc5a650eca1">
     
    ((_sourceCategory=Labs/Windows/OS/Windows))
    | parse "Message = \"*." as message
    | parse "ComputerName = \"*\";" as computer
    | where eventid = "4728" 
    
<img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/35f5a15b-8493-4358-91d0-5be986d56d10">
     
    (((_sourceCategory=Labs/Windows/OS/Windows))) 
    | parse "Group Name:\t\t*\n\tGroup Domain" as group_name 
    | parse "Message = \"*." as message
    | parse "ComputerName = \"*\";" as computer
    | where eventid = "4728"
    | count by computer, message, eventid, group_name 

<img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/b4775fd9-8ef0-4f3b-8f8d-315ada4c9cb2">

    (((_sourceCategory=Labs/Windows/OS/Windows)))
    | parse "Group Name:\t\t*\n\tGroup Domain" as group_name 
    | parse "Message = \"*." as message
    | parse "ComputerName = \"*\";" as computer
    | where eventid = "4728"
    | where group_name = "Domain Admins"
    | count by computer, message, eventid, group_name 
    
  <img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/eb1f1a5c-db3b-4ff5-b16e-2b77bb2db1db">
   
    (((((_sourceCategory=Labs/Windows/OS/Windows))))) 
    | parse "Account Name:\t\t*\n\tAccount" as account_name 
    | parse "Group Name:\t\t*\n\tGroup Domain" as group_name 
    | parse "Message = \"*." as message
    | parse "ComputerName = \"*\";" as computer
    | where eventid = "4728" 
    | where group_name = "Domain Admins" 
    | count by computer, message, eventid, group_name, account_name 

  <img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/9e6c2777-cc05-4db8-a0b8-bd1bbcda3c72">

     _sourceCategory=Labs/Windows/OS/Windows 
    | parse "InsertionStrings = {\"*\"," as user
    | parse "ComputerName = \"*\";" as computer 
    | where eventid = "4769" 

  <img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/4b5249f6-5963-4039-80f5-2ed450825d20">
     
    _sourceCategory=Labs/Windows/OS/Windows
    | timeslice 15m
    | parse "InsertionStrings = {\"*\"," as user
    | parse "ComputerName = \"*\";" as computer 
    | where eventid = "4769" 
    | count_distinct(computer) group by _timeslice, user 
    
  <img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/9ebf2abe-4d98-4b80-9743-1a9626e849b3">
 
    _sourceCategory=Labs/Windows/OS/Windows 
    | timeslice 15m
    | parse "InsertionStrings = {\"*\"," as user
    | parse "ComputerName = \"*\";" as computer
    | where eventid = "4769"
    | where !(user matches "*$*")
    | count_distinct(computer) group by _timeslice, user
    
<img width="720" alt="image" src="https://github.com/gabizzle/Intrusion-Detection/assets/67624149/d08b446f-98f8-42ce-b322-2db33d719e46">
    
    _sourceCategory=Labs/Windows/OS/Windows
    | timeslice 15m
    | parse "InsertionStrings = {\"*\"," as user
    | parse "ComputerName = \"*\";" as computer
    | where eventid = "4769"
    | count_distinct(computer) group by _timeslice, user
