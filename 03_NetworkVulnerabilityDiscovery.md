# Network Vulnerability Discovery

## Port States and Techniques
- The research will talk about different techniques to scan ports. It is about knowing whether or not users or attackers are snooping around a network or specific ports, assuming they have vulnerabilities. These vulnerabilities can be indicators for users to exploit as a means of checking a network by listening or scanning, or they can maliciously act on it. There are a total of 65,535 available ports on a computer, and some of these ports have specific assignments, but it does not give them any unique characteristics that leave them out of threat.
- Ports have different states, which indicate the status of a port. These indicators help attackers know what to do with specific port statuses when it is showing.

### Port States

**Open**
  -	Accepts any response
  -	Target for attacks
  -	Shows available services on the network
    
**Closed**
  -	Accessible in a way that receives and responds to probe packets but indicates that no applications are listening on it
  -	Can possibly open up
    
**Filtered**
  -	Typically prevents an unknown packet from reaching the port if not identified
  -	Can have different filterings such as firewalls, router rules, and the like.
    
**Unfiltered**
  -	These ports are accessible but do not indicate whether the port is open or closed
    
**Open | Filtered**
  -	Does not determine whether the port is open or filtered since they do not give a response back, which could indicate the packet dropping
    
**Closed | Filtered**
  -	Does not determine whether a port is closed or filtered

### Port Techniques
1. TCP SYN scan
   Command: ``-sS ``
    -	Default
    -	Most popular scanning option
    -	Can scan thousands of ports quickly not blocked by firewall
    -	Referred to as, a “half-open port” because it does not open a full TCP connection
      
2. TCP connect scan
    Command: ``-sT ``
    -	Default TCP scan when SYN scan is not an option
    -	When a user has no raw packet privilege
    -	NMAP asks the OS to establish a connection with the target machine and port through connect  system call UDP scans
    
3. UDP scans
   Command: ``-sU``
    -	More difficult, and slower than TCP
    -	Can be combined with -sS  to check both protocols running
    -	UDP scan works by sending a UDP packet to every targeted port
  
4. SCTP INIT scans
   Command: ``-sY``
    -	Combines characteristics of TCP and UDP
    -	SCTP equivalent of a TCP SYN scan; performs quickly
    -	Referred to as “half-open scanning” because it does not open a full SCTP association
  
5. TCP NULL, FIN, and Xmas scans
   Command: ``-sN``; ``-sF``; ``-sX``
    -	Exploits a subtle loophole in TCP RFC to differentiate open and closed ports.
    -	The key advantage to these scan types is that they can sneak through certain non-stateful firewalls and packet filtering routers
    -	Another advantage is that these scan types are a little more stealthy than even a SYN scan

     	Null scan ``(-sN)``
        o	Does not set any bits (TCP flag header is 0)
      FIN scan ``(-sF)``
        o	Sets just the TCP FIN bit.
      Xmas scan ``(-sX)``
        o	Sets the FIN, PSH, URG flags, lighting the packet up like a Christmas tree
 	
6. TCP ACK scans
   Command: ``-sA``
      -	Used to map out firewall rulesets to determine if a port is filtered or not
      -	Always labeled as unfiltered even if as they receive an ACK

7. TCP Window scan
   Command: ``-sW``
      -	The same as TCP ACK scan, but exploits the implementation and receives an RST, rather than an unfiltered label
    
8. TCP Maimon scan
   Command: ``-sM``
      -	The same as NULL, FIN, and Xmas scans, but the probe is FIN/ACK
      
9. Command: ``--scanflags``
      -	Allows a user to design their own scans by specifying arbitrary TCP flags
      -	Allows you to combine different symbolic names
  
10. SCTP COOKIE ECHO scan
    Command: ``--sZ``
      -	More advanced than SCTP
      -	Takes advantage of droping packets silently when they contain COOKIE ECHO
      -	Cannot differentiate between open and filtered ports, leaving you with the state open|filtered in both cases.
  
11.	Idle scan
    Command: ``-sI <zombie host>[:<probeport>]``
      -	Allows a blind TCP scan  where the target does not know the real IP address of where the packet came from through a zombie machine
      -	Can show port listings from the perspective of the zombie host
  
12.	IP Protocol scan
    Command: ``-sO``
      -	Lets a user now with IP protocols are supported by target machines
  
13.	FTP bounce scan
    Command: ``-b <FTP relay host>``
      -	Allows a user to connect to an FTP server, and request files to be sent to a third-party server
      -	takes an argument of the form <username>:<password>@<server>:<port>. <Server> is the name or IP address of a vulnerable FTP server.

## Business Implications and Actions
The techniques and uses above is an open source for many users to be able to use. Since port scanning is not illegal, actions regarding it are debatable. Some organizations or companies may use these to learn about their rivals. 
Organizations may also use it to attack a rival business and have its business slow down or stop. However, organizations may also use these techniques to check their networks and test their vulnerabilities. 
They may be able to secure their networks and systems away from possible threats from any party. In the short run, organizations or users may encounter problems that cause a slow connection, while in the long run, if network issues cannot be fixed, it can affect the business and its reputation. 
It may slow down the processes going through the network and crash their systems. It will lead to a costly amount of money and time to address these issues. An organization should invest in proper practices and training to secure its network rather than spend it on attacks and remedies. 
To avoid cases of port scanning, protocols should be placed in order to prove and secure proper usage of scanning.

Below are examples of what can be done:

1. Written consent
2. Dates and times for and of scanning
3. IP ranges to be scanned
4. Names of systems and networks to be scanned
5. Scanning tools to be used
6. People conducting the scans
7. If a remote scan is planned, including the IP address of the scanning tool
   
## References
- https://nmap.org/book/man-port-scanning-techniques.html
- https://nmap.org/book/man-port-specification.html

## Figures

<div align="center"> 
  
  #### Figure 1 – Scan on the Local Machine
  
  #### Figure 2 – Scan on NMAP
  
  #### Figure 3 – Scan for Service Version

  #### Figure 4 – Identifying System Version
  
</div>


