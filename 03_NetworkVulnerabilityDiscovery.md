# üîç Network Vulnerability Discovery

## üìò Port States and Scanning Techniques

This section covers techniques used to scan ports and interpret their states. Understanding port behavior helps in identifying whether users or attackers are probing a network, often searching for vulnerable services. There are 65,535 ports available on a host system‚Äîsome assigned to specific services, but all potentially susceptible to misuse.

### üö¶ Port States

| **State**            | **Description** |
|----------------------|-----------------|
| **Open**             | - Accepts connections and responds to probes<br>- Reveals running services<br>- Primary targets for attackers |
| **Closed**           | - Responds to probes but no service is listening<br>- May open in the future |
| **Filtered**         | - Packet is dropped (no response)<br>- Commonly caused by firewalls, ACLs, routers |
| **Unfiltered**       | - Port responds to probes, but scan can‚Äôt determine if it‚Äôs open or closed |
| **Open | Filtered**  | - No response received<br>- Could be open or filtered (indeterminate) |
| **Closed | Filtered**| - No definitive indication if closed or filtered |

---

### üõ†Ô∏è Port Scanning Techniques

#### 1. TCP SYN Scan  
Command: ``-sS``  
- Default and most popular scan type  
- Fast, stealthy (half-open connection)  
- Bypasses some firewalls  

#### 2. TCP Connect Scan  
Command: ``-sT``  
- Used when SYN scan is not possible  
- Relies on OS-level `connect()` system call  
- Not as stealthy  

#### 3. UDP Scan  
Command: ``-sU``  
- Slower and more difficult than TCP  
- Can be combined with ``-sS`` for full coverage  
- Sends UDP packets to each port  

#### 4. SCTP INIT Scan  
Command: ``-sY``  
- SCTP equivalent of TCP SYN  
- Half-open scan for SCTP services  

#### 5. TCP NULL, FIN, and Xmas Scans  
Commands: ``-sN``, ``-sF``, ``-sX``  
- Exploits TCP RFC behavior  
- Can bypass non-stateful firewalls  
- More stealthy than SYN scans  

| **Type**    | **Behavior** |
|-------------|--------------|
| NULL        | No flags set |
| FIN         | Only FIN flag set |
| Xmas        | FIN, PSH, URG flags set (like a "lit-up" packet) |

#### 6. TCP ACK Scan  
Command: ``-sA``  
- Maps firewall rule sets  
- Determines if ports are filtered  

#### 7. TCP Window Scan  
Command: ``-sW``  
- Similar to ACK scan  
- Analyzes TCP window size to infer port state  

#### 8. TCP Maimon Scan  
Command: ``-sM``  
- Sends FIN/ACK probe  
- Variant of NULL/FIN/Xmas scans  

#### 9. Custom Scan Flags  
Command: ``--scanflags``  
- Specify custom TCP flags for specialized scanning  
- Useful for obfuscation and testing edge behavior  

#### 10. SCTP COOKIE ECHO Scan  
Command: ``--sZ``  
- Sends COOKIE ECHO chunks  
- If dropped, returns an `open|filtered` state  

#### 11. Idle Scan  
Command: ``-sI <zombie_host>[:<probeport>]``  
- Spoofs source IP using a "zombie" host  
- Stealthy; does not reveal origin of scan  

#### 12. IP Protocol Scan  
Command: ``-sO``  
- Determines which IP protocols are supported by the host  

#### 13. FTP Bounce Scan  
Command: ``-b <FTP relay host>``  
- Uses vulnerable FTP servers to proxy scan traffic  
- Format: `<username>:<password>@<server>:<port>`  
- Abuses the PORT command for indirect access  

---

## üõ†Ô∏è Activity

### üìä Figures

<div align="center">

### üì∑ Figure 1 ‚Äì Scan on the Local Machine  
![Figure 1](https://github.com/gabizzle/Intrusion-Detection/assets/67624149/7d9bd1c4-90bd-4da5-9244-0c980aef2a5b)

### üì∑ Figure 2 ‚Äì Scan on NMAP  
![Figure 2](https://github.com/gabizzle/Intrusion-Detection/assets/67624149/741fd648-ee84-4ef4-bd0d-37ba0c436661)

### üì∑ Figure 3 ‚Äì Scan for Service Version  
![Figure 3](https://github.com/gabizzle/Intrusion-Detection/assets/67624149/67ebbe98-385d-404d-9aaa-1ce091c92bac)

### üì∑ Figure 4 ‚Äì Identifying System Version  
![Figure 4](https://github.com/gabizzle/Intrusion-Detection/assets/67624149/012b6684-ae53-4c90-88f8-b52b826aa154)

</div>

## üíº Business Implications

Port scanning techniques, as outlined above, are widely accessible as open-source tools and are commonly used by both security professionals and malicious actors. While port scanning itself is not illegal, its intent and context determine whether it is ethical, acceptable, or punishable. This ambiguity presents significant business implications.

### üß≠ Ethical and Strategic Uses

Organizations may:
- Use scanning techniques internally to identify vulnerabilities and strengthen network defenses.
- Employ port scanning during red-teaming or penetration testing exercises for proactive threat management.
- However, some entities may abuse these techniques for corporate espionage, sabotage, or to deliberately slow down a rival‚Äôs operations.

> ‚ö†Ô∏è While these tools can enhance cybersecurity, they can also be weaponized to disrupt, expose, or degrade rival business systems.

### üîπ Short-Term Risks
- **Performance Degradation**: Scanning activities may consume bandwidth, introduce latency, or trigger false positives in security systems.
- **Unintended Downtime**: Poorly executed scans can crash services or expose misconfigurations.
- **Reputational Hit**: If identified as the origin of an unauthorized scan, an organization may suffer reputational harm or legal scrutiny.

### üî∏ Long-Term Risks
- **Systemic Vulnerability**: Failure to patch identified weaknesses can lead to persistent exposure to breaches.
- **Legal Consequences**: Aggressive or undocumented scanning‚Äîespecially without permission‚Äîcan be deemed intrusive, triggering lawsuits or audits.
- **Loss of Trust**: Stakeholders and partners may question an organization's ethics and cybersecurity posture.

### üß© Business Impact
- **Financial**: Recovery from network degradation or breach incidents requires significant investment in manpower and infrastructure.
- **Strategic**: Insecure or unstable networks can delay product rollouts, erode service reliability, or limit access to new markets.
- **Operational**: Ongoing network instability can lead to system crashes, data corruption, or loss of availability‚Äîdisrupting business continuity.

---

## ‚úÖ Best Practices for Responsible Scanning

To avoid misuse and ensure ethical scanning, organizations should implement clear protocols and maintain transparency. The following elements are recommended for any internal or third-party port scanning activity:

1. **Written Consent** ‚Äì Get approval from system/network owners.
2. **Defined Schedule** ‚Äì Document dates and times when scanning is permitted.
3. **Target Scope** ‚Äì Specify IP ranges, domains, or systems to be scanned.
4. **System Identification** ‚Äì Clarify which business units, environments, or platforms are involved.
5. **Tool Declaration** ‚Äì List the scanning tools and configurations to be used.
6. **Personnel Disclosure** ‚Äì Name individuals or teams responsible for execution.
7. **Remote Scan Details** ‚Äì If scanning remotely, provide the scanner‚Äôs IP address and location.

> üõ°Ô∏è Organizations should invest in training, policies, and tooling that encourage **secure network practices**‚Äînot just reactive fixes or offensive tactics. Prevention is always more cost-effective than recovery.

---

## üß© Enterprise Actions

In response to the findings from the network vulnerability discovery exercise, enterprises must take strategic and coordinated actions. Below is a synthesis of the investigation and its implications, along with a holistic remediation plan tailored to each observed scenario.

---

### üîé Investigation Summary

The activity revealed:
- Multiple ports in **open** or **filtered** states across internal systems
- Exposure of services with outdated or unverified versions (Figure 3)
- Incomplete OS fingerprinting protection (Figure 4)
- Potential misconfigurations in firewalls or ACLs
- Active scanning behaviors that could impact performance or trigger external alerts

---

### üí° Implications and Risks

- **Security Risks**: Unfiltered or open ports can act as entry points for threat actors to exploit known vulnerabilities.
- **Operational Risks**: Scans may lead to service interruptions or system instability if conducted without proper controls.
- **Compliance Risks**: Poor visibility and undocumented scanning may violate internal security policies or external regulations.
- **Reputational Risks**: Unauthorized scans (even internal) can create audit findings or interdepartmental distrust.

---

### üõ†Ô∏è Remediation Plan

| **Issue** | **Remediation** | **Responsible Teams** |
|-----------|------------------|------------------------|
| Open ports with no documented service | Conduct service inventory and close unused ports | IT Ops / Network Security |
| Exposed outdated services | Patch or upgrade vulnerable software versions | App Owners / Vulnerability Management |
| Lack of scan governance | Implement internal scanning policy and change control | SecOps / Compliance |
| Missing filtering or segmentation | Review and enforce firewall rules, isolate high-risk assets | Network Security |
| Incomplete OS detection protection | Harden OS fingerprinting responses (e.g., via `iptables`, `pf`) | Infrastructure Security |
| Unauthorized or ad-hoc scans | Create centralized scan scheduling and approval workflow | GRC / Security Engineering |

---

### üìà Strategic Outcomes

- **Improved Visibility**: Full documentation of active ports, protocols, and services.
- **Stronger Perimeter Defense**: Reduced attack surface via port hardening and firewall tuning.
- **Better Audit Readiness**: Clear paper trail for all scanning activities and incident responses.
- **Cultural Shift to Proactive Security**: Teams trained and aligned with ethical security practices, moving from reactive to preventive controls.

> üîê The ultimate goal is not just to block threats, but to **build a security culture** that balances availability, integrity, and confidentiality across the organization.

---

## References
- https://nmap.org/book/man-port-scanning-techniques.html
- https://nmap.org/book/man-port-specification.html



